name: host deploy 
on: 
  workflow_call:
    inputs:
      module:
        required: true
        type: string
      env:
        required: false
        type: string
jobs:
  deploy:
    runs-on: [self-hosted]
    continue-on-error: true 
    steps:
      - if: inputs.env == 0
        run: |
          helm uninstall -n demo ${{ inputs.module }}
        continue-on-error: false 

          
      - if: inputs.env != 0
        run: |
          helm uninstall -n demo ${{ inputs.module }}-${{ inputs.env }}
        continue-on-error: false 

          
      - if: inputs.env == 0
        run: |
          helm install -n demo ${{ inputs.module }} ~/code/helm/charts/demo/${{ inputs.module }}
        continue-on-error: true 

      
      - if: inputs.env != 0
        run: |
          helm install -n demo ${{ inputs.module }}-${{ inputs.env }} ~/code/helm/charts/demo/${{ inputs.module }}-${{ inputs.env }}
        continue-on-error: true 


        
